---
import Layout from '../../layouts/Layout.astro';
import { marcas } from '../../lib/mangos';
import Galeria from '../../components/Galeria.astro';


export function getStaticPaths() {
  // Generar las rutas basadas en las marcas
  return marcas.map((marca) => ({
    params: {
      grupo: marca.slug
    },
  }));
}

const { grupo } = Astro.params;

const miMarca = marcas.find((m) => m.slug == grupo);

// Verificación para evitar errores si no se encuentra la marca
if (!miMarca) {
  console.error(`No se encontró la marca: ${grupo}`);
}
---

<Layout title="Productos de la Marca">
  <main class="sm:w-4/5 m-auto flex flex-col justify-center items-center mt-10 text-white">

     <!-- Imagen de la marca -->
     {miMarca ? (
      <img src={`/images/${miMarca.slug}.png`} alt={`Logo de ${miMarca.titulo}`} class="mb-8 w-2/3 mt-10 " />
    ) : (
      <p>No se encontró la marca</p>
    )}

    {miMarca?.productos?.length > 0 ? (
      miMarca.productos.map((miProducto) => (
        <section class="w-full flex sm:flex-row flex-col justify-center items-center mt-24 mb-12">
          <div class="w-full order-2 sm:w-1/2 flex flex-col justify-center items-center mb-10">
            {miProducto?.fotos?.length > 0 ? (
              <Galeria 
                img1={miProducto.fotos[0]} 
                img2={miProducto.fotos[1]} 
                img3={miProducto.fotos[2]} 
                nombre1={miProducto.sabores[0]} 
                nombre2={miProducto.sabores[1]} 
                nombre3={miProducto.sabores[2]} 
              />
            ) : (
              <p>No hay imágenes disponibles</p>
            )}
          </div>
          
          <div class="w-4/5 sm:w-1/2">
            <article>
              <div>
                <h1 class="font-pepsi-compress text-white text-6xl my-4">{miProducto.titulo}</h1>
                <p class="text-justify">{miProducto.detalles}</p>
              </div>
              <ul class="mb-2 mt-6">
                <li><span class="font-bold">Calories:</span> {miProducto.calorias || 'No disponible'}</li>
                <li><span class="font-bold">Sweetener System:</span> {miProducto.sweetnerSystem || 'No disponible'}</li>
                {miProducto.info && miProducto.info.length > 0 && (
                  <>
                    <li><span class="font-bold">Additional Info:</span></li>
                    {miProducto.info.map((info, index) => (
                      <li key={index}>{info}</li>
                    ))}
                  </>
                )}
              </ul>
              <div class="flex justify-start gap-4 my-6">
                {miProducto.paises && miProducto.paises.length > 0 ? (
                  miProducto.paises.map((pais, index) => (
                    <img key={index} class="h-12" src={`/images/${pais}.webp`} alt={`Bandera de ${pais}`} />
                  ))
                ) : (
                  <p>No hay países disponibles</p>
                )}
              </div>
            </article>
          </div>
        </section>
      ))
    ) : (
      <p>No hay productos disponibles para esta marca</p>
    )}
  </main>
</Layout>
